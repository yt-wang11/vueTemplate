<template>
  <div v-if="loading" :class="['w-skeleton', {
    'is-animated': animated
  }]">
    <!-- extra -->
    <div v-if="extraConfig" class="w-skeleton__extra"
      :style="renderExtraStyle()"></div>
    <!-- content -->
    <div class="w-skeleton__content"
      :style="renderContentStyle()">
      <div v-for="index in (rows + 1)" :key="index"
        class="w-skeleton__item"
        :style="renderItemStyle(index)">
        <div class="w-skeleton__item--left"
          :style="renderItemStyle(index, 'left')"></div>
        <div class="w-skeleton__item--right"
          :style="renderItemStyle(index, 'right')"></div>
      </div>
    </div>
  </div>
</template>
<script>
export default {
  name: 'WSkeleton',
  data () {
    return {
    }
  },
  props: {
    animated: Boolean,
    loading: {
      type: Boolean,
      default: true
    },
    rows: {
      type: Number,
      default: 3
    },
    contentConfig: Object,
    extraConfig: Object
  },
  methods: {
    renderContentStyle () {
      if (!this.extraConfig) return
      const { position, size } = this.extraConfig
      if (position === 'top') return
      const width = Array.isArray(size) && size ? size[0] : size
      return {
        float: position === 'left' ? 'right' : (position === 'right' ? 'left' : null),
        width: `calc(100% - ${width} - 20px)`
      }
    },
    renderExtraStyle () {
      const { size, shape, position } = this.extraConfig
      const width = Array.isArray(size) && size ? size[0] : size
      const height = Array.isArray(size) && size ? size[1] : size
      const { itemSpace } = this.contentConfig || {}
      return {
        float: position,
        width,
        height,
        marginTop: (position === 'left' || position === 'right') ? (itemSpace || '20px') : null,
        borderRadius: shape === 'circle' ? '100%' : '0px'
      }
    },
    renderItemStyle (index, des) {
      if (!this.contentConfig) return
      const { itemSpace, itemHeight } = this.contentConfig
      switch (des) {
        case 'left':
          return {
            height: itemSpace
          }
        case 'right':
          return {
            width: index === this.rows ? '20%' : null,
            height: itemSpace
          }
        default:
          return {
            marginTop: index - 1 ? itemHeight : null,
            height: itemSpace
          }
      }
    }
  }
}
</script>
