<template>
    <span :class="['w-link', {
        'is-actived': actived === selector
      }]">
      <h3 v-text="title" :class="['w-link__title']"
        @click="handleClick" @mouseenter="handleHover"></h3>
      <div class="w-link__slot">
        <slot></slot>
      </div>
    </span>
</template>
<script>
import Emitter from '../../../mixins/emitter'
import smoothScroll from '../../../utils/smooth-scroll'
export default {
  name: 'WLink',
  data () {
    return {
    }
  },
  inject: {
    wAnchor: {
        default: ''
      }
  },
  props: {
    title: String,
    selector: String
  },
  computed: {
    actived () {
      return this.wAnchor && this.wAnchor.$data.actived
    },
    offset () {
      return this.wAnchor && this.wAnchor.$props.offset || 0
    },
    getContainer () {
      return this.wAnchor && this.wAnchor.$props.getContainer
    }
  },
  mixins: [Emitter],
  methods: {
    handleHover (ev) {
      this.dispatchEvent('WAnchor', 'linkHover', [{
        ev,
        selector: this.selector
      }])
    },
    handleClick (ev) {
      smoothScroll.scrollToElement(document.querySelector(this.selector), this.getContainer, 450, this.offset)
      this.dispatchEvent('WAnchor', 'linkClick', [{
        ev,
        link: {
          ...this,
          actived: this.selector
        }
      }])
    }
  },
  mounted () {
    this.dispatchEvent('WAnchor', 'addLink', [this.selector])
  }
}
</script>
