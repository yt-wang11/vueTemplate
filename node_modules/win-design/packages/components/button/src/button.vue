<template>
  <button :disabled="isDisabled || loading"
          :autofocus="autofocus"
          :type="nativeType"
          :class="['w-button',
            type ? 'w-button--' + type : '',
            buttonSize ? 'w-button--' + buttonSize : '',
            {
              'is-disabled': isDisabled,
              'is-loading': loading,
              'is-plain': plain,
              'is-dashed': dashed,
              'is-round': round,
              'is-circle': circle
            }
          ]"
          @click="handleClick" @mouseenter="handleMouseenter" @mouseleave="handleMouseleave">
    <i v-if="loading" class="w-icon-loading"></i>
    <i v-if="icon && !loading" :class="icon"></i>
    <span v-if="$slots.default">
      <slot></slot>
    </span>
  </button>
</template>
<script>
  export default {
    name: 'WButton',
    data () {
      return {}
    },
    inject: {
      wForm: {
        default: ''
      },
      wFormItem: {
        default: ''
      }
    },
    props: {
      autofocus: Boolean,
      round: Boolean,
      circle: Boolean,
      disabled: Boolean,
      icon: {
        type: String,
        default: ''
      },
      loading: Boolean,
      nativeType: {
        type: String,
        default: 'button'
      },
      dashed: Boolean,
      plain: Boolean,
      size: {
        type: String,
        default: 'medium'
      },
      type: {
        type: String,
        default: 'default'
      }
    },
    computed: {
      buttonSize () {
        if (!this.wForm || !this.wForm.$props.sizes) return this.size
        return this.wForm.$props.sizes
      },
      isDisabled () {
        return this.disabled
      }
    },
    methods: {
      handleClick () {
        this.$emit('click')
      },
      handleMouseenter () {
        this.$emit('mouseenter')
      },
      handleMouseleave () {
        this.$emit('mouseleave')
      }
    }
  }
</script>
